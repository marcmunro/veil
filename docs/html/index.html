<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Veil: Veil</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Veil
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Veil </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section version"><dt>Version</dt><dd>9.5.0 (Stable)) </dd></dl>
<h1><a class="anchor" id="license"></a>
License</h1>
<p>BSD </p>
<h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>Veil is a data security add-on for Postgres. It provides an API allowing you to control access to data at the row, or even column, level. Different users will be able to run the same query and see different results. Other database vendors describe this as a Virtual Private Database.</p>
<h1><a class="anchor" id="Why"></a>
Why do I need this?</h1>
<p>If you have a database-backed application that stores sensitive data, you will be taking at least some steps to protect that data. Veil provides a way of protecting your data with a security mechanism within the database itself. No matter how you access the database, whether you are a legitimate user or not, you cannot by-pass Veil without superuser privileges.</p>
<h2><a class="anchor" id="Advantages"></a>
Veil Advantages</h2>
<p>By placing security mechanisms within the database itself we get a number of advantages:</p><ul>
<li>Ubiquity. Security is always present, no matter what application or tool is used to connect to the database. If your application is compromised, your data is still protected by Veil. If an intruder gets past your outer defences and gains access to psql, your data is still protected.</li>
<li>Single Security Policy and Implementation. If you have N applications to secure, you have to implement your security policy N times. With Veil, all applications may be protected by a single implementation.</li>
<li>Strength in Depth. For the truly security conscious, Veil provides yet another level of security. If you want strength in depth, with layers and layers of security like an onion, Veil gives you that extra layer.</li>
<li>Performance. Veil is designed to be both flexible and efficient. With a good implementation it is possible to build access controls with a very low overhead, typically much lower than building the equivalent security in each application.</li>
<li>Cooperation. The Veil security model is designed to cooperate with your applications. Although Veil is primarily concerned with data access controls, it can also be used to provide function-level privileges. If your application has a sensitive function X, it can query the database, through Veil functions, to ask the question, "Does the current user have
execute_X privilege?". Also, that privilege can be managed in exactly the same way as any other privilege.</li>
<li>Flexibility. Veil is a set of tools rather than a product. How you use it is up to you.</li>
</ul>
<h2><a class="anchor" id="Limitations"></a>
Veil Limitations</h2>
<p>Veil can restrict the data returned by queries but cannot prevent the query engine itself from seeing restricted data. In particular, functions executed during evaluation of the where clause of a query may be able to see data that Veil is supposed to restrict access to.</p>
<p>As an example let's assume that we have a secured view, users, that allows a user to see only their own record. When Alice queries the view, she will see this:</p>
<pre class="fragment">select * from users;

  userid  |   username
----------+-----------
   12345  |   Alice
</pre><p>Alice should not be able to see any details for Bob or even, strictly speaking, tell whether there is an entry for Bob. This query though:</p>
<pre class="fragment">select * from users 
where 0 = 9 / (case username when 'Bob' then 0 else 1 end);
</pre><p>will raise an exception if the where clause encounters the username 'Bob'. So Alice can potentially craft queries that will enable her to discover whether specific names appear in the database.</p>
<p>This is not something that Veil is intended to, or is able to, prevent.</p>
<p>A more serious problem occurs if a user is able to create user defined functions as these can easily provide covert channels for leaking data. Consider this query:</p>
<pre class="fragment">select * from users where leak_this(username);
</pre><p>Although the query will only return what the secured view allows it to, the where clause, if the function is deemed inexpensive enough, will see every row in the table and so will be able to leak supposedly protected data. This type of exploit can be protected against easily enough by preventing users from defining their own functions, however there are postgres builtins that can be potentially be exploited in the same way.</p>
<h2><a class="anchor" id="GoodNews"></a>
The Good News</h2>
<p>The news is not all bad. Although Veil can be circumvented, as shown above, a database protected by Veil is a lot more secure than one which is not. Veil can provide extra security over and above that provided by your application, and in combination with a well designed application can provide security that is more than adequate for most commercial purposes.</p>
<h1><a class="anchor" id="the-rest"></a>
Veil Documentation</h1>
<ul>
<li><a class="el" href="overview-page.html">Overview: a quick introduction to Veil</a></li>
<li><a class="el" href="API-page.html">The Veil API</a></li>
<li><a class="el" href="Building.html">Building a Veil-based secure database</a></li>
<li><a class="el" href="Demo.html">A Full Example Application: The Veil Demo</a></li>
<li><a class="el" href="Management.html">Managing Privileges, etc</a></li>
<li><a class="el" href="Esoteria.html">Exotic and Esoteric uses of Veil</a></li>
<li><a class="el" href="install.html">Installation and Configuration</a></li>
<li><a class="el" href="History.html">History and Compatibility</a></li>
<li><a class="el" href="Feedback.html#Feedback">Bugs and Feedback</a></li>
<li><a class="el" href="Performance.html">Performance</a></li>
<li><a class="el" href="Credits.html#Credits">Credits</a></li>
</ul>
<h2><a class="anchor" id="BetterNews"></a>
Better News</h2>
<p>In the latest versions of PostgreSQL, some improvements have been made in the area of security, particularly with respect to security functions and ensuring that untrusted functions may not leak data that should be hidden.</p>
<p>Note that there are likely to be costs associated with some of these improvements, as the query engine will apply untrusted functions later in the query execution plan. If those untrusted functions are used to significantly reduce the size of a dataset, moving their execution to later in the plan may have an adverse effect on performance. For this reason, you should test and benchmark and decide for yourself whether there is a performance hit, and whether the value of improved security is worth any measured loss of performance.</p>
<p>You are also advised to follow the progress of Row Level Security support in later versions of Postgres, as this may obviate your need for Veil, or change the way in which you will use it.</p>
<p>Next: <a class="el" href="overview-page.html">Overview: a quick introduction to Veil</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
